{
  "version": 3,
  "sources": ["../../../src/js/newsletter.js"],
  "sourcesContent": ["\n// gets the page id from body to determine contact page varient\nconst page = document.body.id;\n\nconst form = document.getElementById('ims-form-module-form')\nconst url = 'https://73lxm5v417.execute-api.us-east-1.amazonaws.com/dev/email/send'\nconst feedback = document.querySelector('.message')\nconst submit = document.querySelector('.action-button')\nconst input = document.querySelector('input[name=\"email\"')\n\nconsole.log(input)\n\n\n\nfunction checkValidity(options) {\n    const insertError = options.insertError //default false\n\n    if (!input.validity.valid && input.validationMessage) { //check html5 validation on required inputs and select * all required on this form\n\n        if (insertError) { // see addEventListener's below\n\n            input.nextElementSibling.innerHTML = input.validationMessage // adds error message in existing empty <div>\n            input.nextElementSibling.classList.add('with-errors')\n            input.classList.add('error')\n\n        }\n    } else { // reset error message on typing or selecting\n\n        if (input.nextElementSibling) { //check for Sibling\n\n            input.nextElementSibling.innerHTML = ''\n            input.nextElementSibling.classList.remove('with-errors')\n            input.classList.remove('error')\n        }\n\n    }\n\n}\n\ninput.addEventListener('input', function () {\n    // We can only update the error or hide it on input.\n    // Otherwise it will show when typing.\n    checkValidity({ insertError: false })\n\n})\n\ninput.addEventListener('invalid', function (e) {\n    // prevent showing the default display\n    e.preventDefault()\n\n    // We can also create the error in invalid.\n    checkValidity({ insertError: true })\n})\n\n\n\nfunction post(url, body, callback) {\n  var req = new XMLHttpRequest();\n  req.open(\"POST\", url, true);\n  req.setRequestHeader(\"Content-Type\", \"application/json\");\n  req.addEventListener(\"load\", function () {\n    if (req.status < 400) {\n      callback(null, JSON.parse(req.responseText));\n    } else {\n      callback(new Error(\"Request failed: \" + req.statusText));\n    }\n  });\n  req.send(JSON.stringify(body));\n}\n\nfunction success() {\n  feedback.innerHTML = 'Thank you for signing up for our newsletter!'\n  feedback.style.cssText = 'font-size: 2em;padding: 2em; background-color: aliceblue; border-radius: 10px;margin-bottom: 1em;line-height: 1.4em;';\n  feedback.scrollIntoView()\n  submit.disabled = true\n  submit.innerHTML = 'Message Sent'\n  input.value = ''\n\n}\n\nfunction error(err) {\n  feedback.innerHTML = 'There was an error with sending your message. Please try again or contact us directly by calling 860-589-8367'\n  feedback.style.cssText = 'font-size: 2em;padding: 2em; background-color: #ffcccb;border-radius: 10px;margin-bottom: 1em;line-height: 1.4em;';\n  feedback.scrollIntoView()\n  submit.disabled = false\n  console.log(err)\n}\n\nform.addEventListener('submit', function (e) {\n  e.preventDefault()\n  submit.disabled = true\n\n  const payload = createPayload(page, form)\n\n  post(url, payload, function (err, res) {\n    if (err) {\n      return error(err)\n    }\n    success()\n  })\n})\n\nfunction createPayload(page) {\n  // Setup payload for each page\n  // var inputs = []\n\n  var payload = {\n    page: page,\n    date: (new Date()).toString(),\n    email: input.value,\n    captcha: grecaptcha.getResponse(),\n  }\n\n  return payload\n}\n\n"],
  "mappings": ";;AAEA,MAAM,OAAO,SAAS,KAAK;AAE3B,MAAM,OAAO,SAAS,eAAe,sBAAsB;AAC3D,MAAM,MAAM;AACZ,MAAM,WAAW,SAAS,cAAc,UAAU;AAClD,MAAM,SAAS,SAAS,cAAc,gBAAgB;AACtD,MAAM,QAAQ,SAAS,cAAc,oBAAoB;AAEzD,UAAQ,IAAI,KAAK;AAIjB,WAAS,cAAc,SAAS;AAC5B,UAAM,cAAc,QAAQ;AAE5B,QAAI,CAAC,MAAM,SAAS,SAAS,MAAM,mBAAmB;AAElD,UAAI,aAAa;AAEb,cAAM,mBAAmB,YAAY,MAAM;AAC3C,cAAM,mBAAmB,UAAU,IAAI,aAAa;AACpD,cAAM,UAAU,IAAI,OAAO;AAAA,MAE/B;AAAA,IACJ,OAAO;AAEH,UAAI,MAAM,oBAAoB;AAE1B,cAAM,mBAAmB,YAAY;AACrC,cAAM,mBAAmB,UAAU,OAAO,aAAa;AACvD,cAAM,UAAU,OAAO,OAAO;AAAA,MAClC;AAAA,IAEJ;AAAA,EAEJ;AAEA,QAAM,iBAAiB,SAAS,WAAY;AAGxC,kBAAc,EAAE,aAAa,MAAM,CAAC;AAAA,EAExC,CAAC;AAED,QAAM,iBAAiB,WAAW,SAAU,GAAG;AAE3C,MAAE,eAAe;AAGjB,kBAAc,EAAE,aAAa,KAAK,CAAC;AAAA,EACvC,CAAC;AAID,WAAS,KAAKA,MAAK,MAAM,UAAU;AACjC,QAAI,MAAM,IAAI,eAAe;AAC7B,QAAI,KAAK,QAAQA,MAAK,IAAI;AAC1B,QAAI,iBAAiB,gBAAgB,kBAAkB;AACvD,QAAI,iBAAiB,QAAQ,WAAY;AACvC,UAAI,IAAI,SAAS,KAAK;AACpB,iBAAS,MAAM,KAAK,MAAM,IAAI,YAAY,CAAC;AAAA,MAC7C,OAAO;AACL,iBAAS,IAAI,MAAM,qBAAqB,IAAI,UAAU,CAAC;AAAA,MACzD;AAAA,IACF,CAAC;AACD,QAAI,KAAK,KAAK,UAAU,IAAI,CAAC;AAAA,EAC/B;AAEA,WAAS,UAAU;AACjB,aAAS,YAAY;AACrB,aAAS,MAAM,UAAU;AACzB,aAAS,eAAe;AACxB,WAAO,WAAW;AAClB,WAAO,YAAY;AACnB,UAAM,QAAQ;AAAA,EAEhB;AAEA,WAAS,MAAM,KAAK;AAClB,aAAS,YAAY;AACrB,aAAS,MAAM,UAAU;AACzB,aAAS,eAAe;AACxB,WAAO,WAAW;AAClB,YAAQ,IAAI,GAAG;AAAA,EACjB;AAEA,OAAK,iBAAiB,UAAU,SAAU,GAAG;AAC3C,MAAE,eAAe;AACjB,WAAO,WAAW;AAElB,UAAM,UAAU,cAAc,MAAM,IAAI;AAExC,SAAK,KAAK,SAAS,SAAU,KAAK,KAAK;AACrC,UAAI,KAAK;AACP,eAAO,MAAM,GAAG;AAAA,MAClB;AACA,cAAQ;AAAA,IACV,CAAC;AAAA,EACH,CAAC;AAED,WAAS,cAAcC,OAAM;AAI3B,QAAI,UAAU;AAAA,MACZ,MAAMA;AAAA,MACN,OAAO,oBAAI,KAAK,GAAG,SAAS;AAAA,MAC5B,OAAO,MAAM;AAAA,MACb,SAAS,WAAW,YAAY;AAAA,IAClC;AAEA,WAAO;AAAA,EACT;",
  "names": ["url", "page"]
}
